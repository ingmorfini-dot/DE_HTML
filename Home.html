<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Applicazione</title>
  <link rel="stylesheet" href="style.css" />
  <script>
function caricaMaschera(nome) {
  // Segnala l'inizio del caricamento
  document.getElementById('ponte').value = 'home:' + nome + ':load';

  fetch(nome + '.html')
    .then(response => response.text())
    .then(html => {
      const contenitore = document.getElementById('contenuto');
      contenitore.innerHTML = ''; // rimuove il contenuto precedente
      contenitore.innerHTML = html; // inserisce il nuovo contenuto

      // Esegui manualmente gli script contenuti nel frammento
      const scripts = contenitore.querySelectorAll('script');
      scripts.forEach(oldScript => {
        const newScript = document.createElement('script');
        if (oldScript.src) {
          newScript.src = oldScript.src;
        } else {
          newScript.textContent = oldScript.textContent;
        }
        document.head.appendChild(newScript);
      });

      // Segnala che la pagina è pronta
      document.getElementById('ponte').value = 'home:' + nome + ':ok';
    })
    .catch(error => {
      console.error('Errore nel caricamento:', error);
    });
}

  </script>
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo" />
    <div class="separator"></div>
    <div class="button-group">
      <button onclick="caricaMaschera('clienti')">👥 Clienti</button>
      <button onclick="caricaMaschera('fornitori')">🏢 Fornitori</button>
      <button onclick="caricaMaschera('progetti')">📁 Progetti</button>
      <button onclick="caricaMaschera('diagnosi')">🔍 Diagnosi</button>
    </div>
  </header>

  <main>
    <div id="contenuto">
      <!-- Qui verrà iniettato il contenuto dinamico -->
    </div>
  </main>

  <footer>
    &copy; 2025 Marco Solutions — Interfaccia Web in HTML + JS + VBA
  </footer>

  <input type="hidden" id="ponte" value="" />
</body>
</html>
